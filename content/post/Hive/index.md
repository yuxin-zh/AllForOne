---
title: "Hive"
date: 2022-02-23T15:24:22+08:00
image: "b2.webp"
---

[TOC]



## 1.Hive Introduction

- HIveæ˜¯ä¸€ä¸ªå¼€æºçš„ **æ•°æ®ä»“åº“**è½¯ä»¶ï¼Œç”¨äºreadï¼Œwriteï¼Œmanageç›´æ¥å­˜å‚¨åœ¨HDFSä¸­çš„å¤§å‹æ•°æ®é›†æ–‡ä»¶

- HQLç”¨äºæ•°æ®æŸ¥è¯¢å’Œåˆ†æ

- HIveæ˜¯åŸºäºè¯»å–çš„å› æ­¤ä¸é€‚ç”¨äºé«˜é¢‘ç‡å†™å…¥æ“ä½œçš„äº‹åŠ¡å¤„ç†

- HIveåŠŸèƒ½

  - æå–/è½¬è½½/åŠ è½½ ï¼ˆETLï¼‰æ•°æ®
  - å­˜å‚¨ æŸ¥è¯¢å’Œåˆ†æHDFSæˆ–Hbaseä¸­å­˜å‚¨çš„å¤§è§„æ¨¡æ•°æ®
  - **æŸ¥è¯¢æ˜¯é€šè¿‡MapReduceå®Œæˆçš„ï¼ŒNoticeğŸ‰ï¼šå¹¶éæ‰€æœ‰æŸ¥è¯¢éƒ½éœ€è¦Mapreduce**
    - Extensionï¼šhiveä¸ºäº†æ‰§è¡Œæ•ˆç‡è€ƒè™‘ï¼Œç®€å•çš„æŸ¥è¯¢å¦‚selectï¼Œä¸å¸¦countï¼Œsum,group byğŸ˜€è¿™æ ·çš„éƒ½ä¸èµ°mapreduceï¼Œç›´æ¥è¯»å–hdfsæ–‡ä»¶è¿›è¡Œfilterè¿‡æ»¤
    - å½“æŸ¥è¯¢è¯­å¥ä¸­çš„è¿‡æ»¤æ¡ä»¶åªæ˜¯åˆ†åŒºå­—æ®µçš„æƒ…å†µä¸‹ä¸ä¼šè¿›è¡Œmapreduce
  - hive-site-xml æœ‰ä¸ªé…ç½®å‚æ•°`hive.fetch.task.conversion = more`å°†è¯¥å‚æ•°è®¾ç½®ä¸ºmoreæ—¶ï¼Œç®€å•æŸ¥è¯¢å°±ä¸ä¼šèµ°mapreduceäº†ï¼Œè‰²æ¹–ä¹‹ä¸ºminimalï¼Œé‚£ä¹ˆä»»ä½•æŸ¥è¯¢éƒ½ä¼šèµ°mapreduceğŸš©

- Hiveå…è®¸ç”¨æˆ·ç¼–å†™è‡ªå·±çš„å‡½æ•°,æœ‰å¦‚ä¸‹ä¸‰ç§ç±»å‹ï¼š

  - ç”¨æˆ·å®šä¹‰å‡½æ•° UDF
  - ç”¨æˆ·å®šä¹‰èšåˆå‡½æ•° UDAF
  - ç”¨æˆ·å®šä¹‰çš„è¡¨ç”Ÿæˆå‡½æ•° UDTF

- Hiveç¼ºç‚¹ï¼š

  - ä¸æ”¯æŒå¤„ç†session
  - æ— æ³•ä¿®æ”¹è¡¨æ•°æ®ï¼ˆæ— æ³•æ›´æ–°ã€åˆ é™¤ã€æ’å…¥ï¼‰åªèƒ½é€šè¿‡æ–‡ä»¶è¿½åŠ å’Œé‡æ–°å¯¼å…¥æ•°æ®
  - æ— æ³•ä¸ºåˆ—ç¼–åˆ¶ç´¢å¼•ï¼ˆæ”¯æŒç´¢å¼•ï¼Œä½†æ— æ³•æé«˜æŸ¥è¯¢é€Ÿåº¦ï¼‰

- Hiveæ•°æ®å­˜å‚¨

  - Hiveå¯ä»¥è§£ææ•°æ®ï¼Œæ‰€ä»¥å°†æ•°æ®å¯¼å…¥Hiveè¡¨åªéœ€å°†æ•°æ®ç§»åŠ¨åˆ°è¡¨æ‰€åœ¨çš„ç›®å½•ï¼ˆæ•°æ®åœ¨HDFSï¼‰,å¦‚æœæ•°æ®åœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œåˆ™éœ€è¦å°†æ•°æ®å¤åˆ¶åˆ°è¡¨æ‰€åœ¨çš„ç›®å½•ä¸­ã€‚ğŸ€„

  - ä»æœ¬åœ°ï¼šExampleï¼šåœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿèˆ¹èˆ°ä¸€ä¸ªåä¸ºlocal.txtçš„æ–‡ä»¶ï¼ˆæ•°æ®ä¹‹é—´ç©ºæ ¼é—´éš”ï¼‰ï¼Œç„¶åæ‰§è¡Œäº†`load data local inpath'ç»å¯¹è·¯å¾„/local.txt into table local;å°±å¯ä»¥ ä½¿ç”¨`hadoop fs -ls

    è·¯å¾„/local æŸ¥çœ‹æ˜¯å¦å¯¼å…¥æˆåŠŸ

  - ä»HDFS:åœ¨HIveä¸­åˆ›å»ºdata_hdfsè¡¨ï¼Œè¡¨ä¸­å‡è®¾æœ‰ä¸¤ä¸ªå­—æ®µï¼šname,age;

    å°†æ–‡ä»¶ä»æœ¬åœ°ä¸Šä¼ åˆ°hdfsï¼š`hadoop fs -put data_hdfs.txt /data`

    hiveå¯¼å…¥`load data inpath 'data/data_hdfs.txt' into table data_hdfs;

- HIveå®¢æˆ·ç«¯

  - Thrift Serverï¼šä¸ºæ‰€æœ‰æ”¯æŒThriftçš„ç¼–ç¨‹è¯­è¨€çš„è¯·iå»æä¾›æœåŠ¡ï¼ˆå‡ ä¹æ‰€æœ‰ä¸»æµè¯­è¨€ï¼‰
  - Thriftå®é™…ä¸Šæ˜¯å®ç°äº†C/Sæ¨¡å¼ï¼Œé€šè¿‡ä»£ç ç”Ÿæˆå·¥å…·å°†thriftæ–‡ç”ŸæˆæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯ä»£ç ï¼ˆå¯ä»¥ä¸ºä¸åŒè¯­è¨€ï¼‰ï¼Œä»è€Œå®ç°æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯è·¨è¯­è¨€çš„æ”¯æŒã€‚ç”¨æˆ·åœ¨Thirftæ–‡ä»¶ä¸­å£°æ˜è‡ªå·±çš„æœåŠ¡ï¼Œè¿™äº›æœåŠ¡ç»è¿‡ç¼–è¯‘åä¼šç”Ÿæˆç›¸åº”è¯­è¨€çš„ä»£ç æ–‡ä»¶ï¼Œç„¶åå®¢æˆ·ç«¯è°ƒç”¨æœåŠ¡ï¼ŒæœåŠ¡å™¨ç«¯ææœåŠ¡ä¾¿å¯ä»¥äº†ã€‚
  - Thriftæ˜¯Facebookäº2007å¹´å¼€å‘çš„è·¨è¯­è¨€çš„rpcæœæ¡†æ¶ï¼Œæä¾›å¤šè¯­è¨€çš„ç¼–è¯‘åŠŸèƒ½ï¼Œå¹¶æä¾›å¤šç§æœåŠ¡å™¨å·¥åšæ¨¡å¼ï¼›ç”¨æˆ·ç»è¿‡Thriftçš„IDLï¼ˆæ¥å£å®šä¹‰è¯­è¨€ï¼‰æ¥æè¿°æ¥å£å‡½æ•°åŠæ•°æ®ç±»å‹ï¼Œè€Œåç»è¿‡Thriftçš„ç¼–è¯‘ç¯å¢ƒç”Ÿæˆå„ç±»è¯­è¨€ç±»å‹çš„æ¥å£æ–‡ä»¶ï¼Œç”¨æˆ·èƒ½å¤Ÿæ ¹æ®æœ¬èº«çš„é¡»è¦é‡‡ç”¨ä¸ä¸€æ ·çš„è¯­è¨€å¼€å‘å®¢æˆ·ç«¯ä»£ç å’ŒæœåŠ¡å™¨ç«¯ä»£ç ã€‚git

    ä¾‹å¦‚ï¼Œæˆ‘æƒ³å¼€å‘ä¸€ä¸ªå¿«é€Ÿè®¡ç®—çš„RPCæœåŠ¡ï¼Œå®ƒä¸»è¦ç»è¿‡æ¥å£å‡½æ•°getIntå¯¹å¤–æä¾›æœåŠ¡ï¼Œè¿™ä¸ªRPCæœåŠ¡çš„getIntå‡½æ•°ä½¿ç”¨ç”¨æˆ·ä¼ å…¥çš„å‚æ•°ï¼Œé€šè¿‡å¤æ‚çš„è®¡ç®—ï¼Œè®¡ç®—å‡ºä¸€ä¸ªæ•´å½¢å€¼è¿”å›ç»™ç”¨æˆ·ï¼›æœåŠ¡å™¨ç«¯ä½¿ç”¨javaè¯­è¨€å¼€å‘ï¼Œè€Œè°ƒç”¨å®¢æˆ·ç«¯èƒ½å¤Ÿæ˜¯javaã€cã€pythonç­‰è¯­è¨€å¼€å‘çš„ç¨‹åºï¼Œåœ¨è¿™ç§åº”ç”¨åœºæ™¯ä¸‹ï¼Œå’±ä»¬åªé¡»è¦ä½¿ç”¨Thriftçš„IDLæè¿°ä¸€ä¸‹getIntå‡½æ•°ï¼ˆä»¥.thriftä¸ºåç¼€çš„æ–‡ä»¶ï¼‰ï¼Œè€Œåä½¿ç”¨Thriftçš„å¤šè¯­è¨€ç¼–è¯‘åŠŸèƒ½ï¼Œå°†è¿™ä¸ªIDLæ–‡ä»¶ç¼–è¯‘æˆCã€javaã€pythonå‡ ç§è¯­è¨€å¯¹åº”çš„â€œç‰¹å®šè¯­è¨€æ¥å£æ–‡ä»¶â€ï¼ˆæ¯ç§è¯­è¨€åªé¡»è¦ä¸€æ¡ç®€å•çš„å‘½ä»¤ä¾¿å¯ç¼–è¯‘å®Œæˆï¼‰ï¼Œè¿™æ ·æ‹¿åˆ°å¯¹åº”è¯­è¨€çš„â€œç‰¹å®šè¯­è¨€æ¥å£æ–‡ä»¶â€ä»¥åï¼Œå°±èƒ½å¤Ÿå¼€å‘å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„ä»£ç äº†ï¼Œå¼€å‘è¿‡ç¨‹å½“ä¸­åªè¦æ¥å£ä¸å˜ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„å¼€å‘èƒ½å¤Ÿç‹¬ç«‹çš„è¿›è¡Œã€‚apa

  - JDBC Driverï¼šç”¨äºhiveå’Œjavaä¹‹é—´å»ºç«‹è¿æ¥
  - **ODBC Driver**ï¼šå…è®¸è‡ªæŒODBCåè®®çš„åº”ç”¨ç¨‹åºè¿æ¥åˆ°hive ğŸ·

- HIve Service

  - HIve CLI ï¼šæ˜¯ä¸€ä¸ªshellï¼Œç”¨äº**æ‰§è¡ŒHiveæŸ¥è¯¢å’Œå‘½ä»¤**
  - HIve Web User Interface:hive cliçš„æ›¿ä»£ï¼Œæä¾›äº†ç›¸åº”åŠŸèƒ½çš„åŸºäºwebçš„GUI
  - HIve Metastoreï¼šä¸€ä¸ª **ä¸­å¤®å­˜å‚¨åº“**ï¼Œå­˜å‚¨ä»“åº“ä¸­çš„**å„ç§è¡¨å’Œåˆ†åŒºçš„æ‰€æœ‰ç»“æ„ä¿¡æ¯**ã€‚è¿˜åŒ…æ‹¬åˆ—çš„å…ƒæ•°æ®åŠå…¶ç±»å‹ä¿¡æ¯ï¼›Used for è¯»å–å’Œå†™å…¥æ•°æ®ä»¥åŠå­˜å‚¨æ•°æ®çš„ç›¸åº”HDFSæ–‡ä»¶çš„åºåˆ—åŒ–ç¨‹åºå’Œååºåˆ—åŒ–æ•°æ®ã€‚ğŸ“
  - HIve Server: æ¥å—æ¥è‡ªä¸åŒå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶å°†å…¶æä¾›ç»™Hiveé©±åŠ¨ç¨‹åº
  - HIve Driver: æ¥æ”¶æ¥è‡ªä¸åŒæ¥æºçš„æŸ¥è¯¢ï¼Œå®ƒ **å°†æŸ¥è¯¢ä¼ è¾“åˆ°ç¼–è¯‘å™¨**
  - HIve Compilerï¼šç›®çš„æ˜¯ **è§£ææŸ¥è¯¢ğŸ”å¹¶å¯¹ä¸åŒçš„æŸ¥è¯¢å¿«å’Œè¡¨è¾¾å¼æ‰§è¡Œè¯­ä¹‰åˆ†æ**ï¼Œ-->å°†HQLè½¬åŒ–ä¸ºMapReduce Job

## 2. HIveæ•°æ®æ¨¡å‹

- ### Tables

  - **æ‰˜ç®¡è¡¨æˆ–å†…éƒ¨è¡¨**ï¼šHIveåœ¨åˆ›å»ºè¡¨æ—¶çš„é»˜è®¤è¡¨ã€‚	
    - ç‰¹ç‚¹ï¼šåœ¨å†…éƒ¨è¡¨è¢«åˆ é™¤åï¼Œè¡¨çš„å…ƒç´ æ®å’Œè¡¨æ•°æ®éƒ½ä»HDFSä¸­å®Œå…¨åˆ é™¤
    - é€‚ç”¨åœºæ™¯ï¼šğŸ‘¤ETLæ•°æ®æ¸…ç†æ­»ç”¨å†…éƒ¨è¡¨åšä¸­é—´è¡¨ï¼Œæ¸…ç†æ—¶HDFSä¸Šçš„æ–‡ä»¶åŒæ­¥æ¸…é™¤ğŸ†‘åœ¨è¯¯åˆ çš„æƒ…å†µä¸‹ï¼Œæ˜“äºå›å¤çš„æ•°æ®ï¼Œç”¨å†…éƒ¨è¡¨â²åœ¨ç»Ÿè®¡åˆ†ææ—¶ï¼Œä¸æ¶‰åŠæ•°æ®å…±äº«çš„æƒ…å†µ
  - å¤–éƒ¨è¡¨ï¼šè¡¨ä¸­çš„æ•°æ®åˆ é™¤åä»»ç„¶åœ¨HDFSä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´åªä¼šåˆ é™¤ç›¸å…³çš„å…ƒæ•°æ®ï¼Œè€Œè¡¨çš„å†…å®¹ä¸ä¼šåˆ é™¤
    - å£°æ˜å¤–éƒ¨è¡¨çš„è¯­æ³•`create external table if not exists `

- Partiotion

  -  **é€šè¿‡åŸºäºä»»ä½•åˆ—æˆ–åˆ†åŒºé”®å°†ç›¸åŒç±»å‹çš„æ•°æ®åˆ†ç»„åœ¨ä¸€èµ·ï¼ŒHIveè¡¨è¢«ç»„ç»‡åœ¨åˆ†åŒºä¸­ï¼Œæ¯ä¸ªè¡¨éƒ½æœ‰ä¸€ä¸ªåˆ†åŒºé”®ç”¨äºè¡¨ç¤º**ï¼Œåˆ†åŒºå¯ä»¥åŠ å¿«æŸ¥è¯¢å’Œåˆ‡ç‰‡è¿‡ç¨‹ã€‚
  -  `create table........... Patitioned BY(partition1 string,partition2 string)`
  -  åˆ†åŒºé€šè¿‡å‡å°‘å»¶è¿Ÿæ¥æé«˜æŸ¥è¯¢é€Ÿåº¦ï¼Œå› ä¸ºå®ƒåªæ‰«æç›¸å…³æ•°æ®ï¼Œè€Œä¸æ‰«æå®Œæ•´æ•°æ®

- åˆ†æ¡¶Buckets

  - è¡¨æˆ–è€…åˆ†åŒºå¯ä»¥å†æ¬¡ç»†åˆ†ä¸ºBucketï¼Œå› æ­¤å¿…é¡»ä½¿ç”¨hashå‡½æ•°ï¼š
  - `create table.....patitioned B....Clustered BY(clolumn 1 ,column 2) Sorted BY(column_name Asc:Desc,_) Into num_bucket Buckets;
  - åˆ†æ¡¶åªæ˜¯è¡¨ç›®å½•ä¸­çš„æ–‡ä»¶ï¼Œå¯ä»¥æ˜¯åˆ†åŒºä¹Ÿå¯ä¸åˆ†åŒºï¼Œç”šè‡³å¯ä»¥é€‰æ‹©nä¸ªbucketå¯¹æ•°æ®è¿›è¡Œåˆ†åŒºã€‚ã€

## 3.Hiveæ•°æ®ç±»å‹

- HIveæ˜¯ç”¨javaå¼€å‘çš„ï¼ŒHIveçš„åŸºæœ¬æ•°æ®ç±»å‹å¯¹åº”äºjavaçš„åŸºæœ¬æ•°æ®ç±»å‹ï¼šTINYINT-1,SMALLINT-2,INT-4,BIGINT-8;

- å¤æ‚æ•°æ®ç±»å‹` create table tt(c1 ARRAY<INT>,c2 MAP<STRING,INT>,c3 STRUCT<a:STRING,b:INT,c:DOUBLE>);`

## 4.HIveServer2

- HiveServer2æ˜¯ä¸€ç§ä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿå¯¹HIveæ‰§è¡ŒæŸ¥è¯¢çš„æœåŠ¡ï¼ˆhs1ç§°ä½œèŠ‚çº¦æœåŠ¡å™¨ï¼ŒåŸºäºThriftåè®®æ„å»ºï¼Œç”¨äºå¤„ç†HIveçš„è·¨å¹³å°é€šè®¯ï¼Œå®ƒå…è®¸ä¸åŒçš„å®¢æˆ·ç«¯å‘hiveæäº¤è¯·æ±‚å¹¶æ£€ç´¢æœ€åç»“æœï¼‰ã€‚**ä½†æ˜¯å®ƒä¸å¤„ç†æ¥è‡ªå¤šä¸ªå®¢æˆ·ç«¯çš„å¹¶å‘è¯·æ±‚ï¼Œå› æ­¤è¢«Hs2æ›¿æ¢**ğŸ·ğŸ·ğŸ·

### 4.1 HS2ä½“ç³»ç»“æ„

- **MetaStoreğŸ‘‹**ï¼šåŸå­˜å‚¨å¯ä»¥é…ç½®ä¸º **åµŒå…¥å¼**æˆ– **è¿œç¨‹æœåŠ¡å™¨**ã€‚HS2ä¸metastoreé€šä¿¡ï¼Œä»¥è·å–æŸ¥è¯¢ç¼–è¯‘æ‰€éœ€è¦çš„å…ƒæ•°æ®
  - åµŒå…¥å¼ï¼šhiveæœåŠ¡å’ŒmetastoreæœåŠ¡è¿è¡Œåœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­ï¼ŒderbyæœåŠ¡ä¹Ÿè¿è¡Œåœ¨è¯¥è¿›ç¨‹ä¸­ã€‚è¯¥æ¨¡å¼æ— éœ€ç‰¹æ®Šé…ç½®ã€‚
  - æœ¬åœ°æ¨¡å¼ï¼šhiveæœåŠ¡å’ŒmetastoreæœåŠ¡è¿è¡Œåœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œmysqlæ˜¯å•ç‹¬çš„è¿›ç¨‹ï¼Œå¯ä»¥åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥åœ¨è¿œç¨‹æœºå™¨ä¸Šã€‚è¯¥æ¨¡å¼åªéœ€å°†hive-site.xmlä¸­çš„ConnectionURLæŒ‡å‘mysqlï¼Œå¹¶é…ç½®å¥½é©±åŠ¨åã€æ•°æ®åº“è¿æ¥è´¦å·å³å¯
  - è¿œç¨‹æ¨¡å¼ï¼šhiveæœåŠ¡å’Œmetastoreåœ¨ä¸åŒçš„è¿›ç¨‹å†…ï¼Œå¯èƒ½æ˜¯ä¸åŒçš„æœºå™¨ã€‚  è¯¥æ¨¡å¼éœ€è¦å°†hive.metastore.localè®¾ç½®ä¸ºfalseï¼Œå¹¶å°†hive.metastore.urisè®¾ç½®ä¸ºmetastoreæœåŠ¡å™¨URIï¼Œå¦‚æœ‰å¤šä¸ªmetastoreæœåŠ¡å™¨ï¼ŒURIä¹‹é—´ç”¨é€—å·åˆ†éš”ã€‚metastoreæœåŠ¡å™¨URIçš„æ ¼å¼ä¸ºthrift://host:portã€‚
- **JDBC ClientğŸ¥**ï¼šJDBCå®¢æˆ·ç«¯ä½¿ç”¨JDBCé©±åŠ¨ä¸HS2äº¤äº’
  - jdbcå¯åŠ¨ä¼ è¾“è¿æ¥ï¼Œé€šè¿‡ **OpenSession API**è°ƒç”¨è·å–ä¼šè¯å¥æŸ„åˆ›å»º **HiveConnection**ï¼Œ **ç»˜ç”»ä½¿ä»æœåŠ¡å™¨ç«¯åˆ›å»º**
  - æ‰§è¡ŒHiveStatementï¼Œå¹¶ä»Thriftå®¢æˆ·æœºå‘å‡ºExecuteStatement APIè°ƒç”¨ã€‚åœ¨APIè°ƒç”¨ä¸­ï¼ŒSessionHandleä¿¡æ¯ä¸æŸ¥è¯¢ä¿¡æ¯ä¸€èµ·ä¼ é€’ç»™æœåŠ¡å™¨
  - HS2è¯·æ±‚é©±åŠ¨ç¨‹åºï¼ˆCommandProcessorï¼‰è¿›è¡ŒæŸ¥è¯¢è§£æå’Œç¼–è¯‘ã€‚é©±åŠ¨ç¨‹åºå¯åŠ¨ä¸€ä¸ªåå°jobï¼Œè¯¥jobä¸MApreduceå¯¹è¯ï¼Œç„¶åå‘å®¢æˆ·ç«¯è¿”å›å“åº”ï¼ˆåŒ…å«ä»æœåŠ¡å™¨ç«¯åˆ›å»ºçš„OperationHandleï¼‰
  - å®¢æˆ·ç«¯ä½¿ç”¨ohä¸hs2å¯¹è¯ï¼Œä»¥æŸ¥è¯¢æ‰§è¡ŒçŠ¶æ€

## 5.Hiveç®¡ç†

- Hiveä¸­çš„æ•°æ®åº“æè¿°äº†ä¸ºäº†ç›¸ä¼¼ç›®çš„æˆ–å±äºç›¸åŒç»„çš„è¡¨çš„é›†åˆã€‚ **æ¯å½“åˆ›å»ºæ•°æ®åº“æ—¶ï¼ŒHIveéƒ½ä¼šåœ¨/user/Hive/warehouse**å¤„ä¸ºæ¯ä¸ªæ•°æ®åº“åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œè¯¥ç›®å½•åœ¨HIve.metastore.warehouse.dirä¸­å®šä¹‰ã€‚

- ```sq
  #æè¿°æ•°æ®åº“
  describe database ....
  #åˆ›å»ºå¸¦æœ‰æ³¨é‡Šçš„æ•°æ®åº“
  create database if not exists t1 comment "Its Niit Project"
  #ä½¿ç”¨dbpropertiesåˆ›å»ºæ•°æ®åº“
  create database if not exists db2 with dbproperties('creator'='Peter','date'='2021-08-02');
  #ç”¨dbpropertiesæè¿°æ•°æ®åº“
  describe database extended t1;
  #åˆ é™¤æ•°æ®åº“åŠå…¶æ‰€æœ‰è¡¨
  deop database if exists æ•°æ®åº“å CASCADE;
  #ä½¿ç”¨é€šé…ç¬¦
  show databases like 'my.*';
  ```

- ```sql
  Create external table ......
  å½“ç”¨æˆ·åˆ›å»ºå†…éƒ¨è¡¨æ—¶ï¼Œå®ƒä¼šå°†æ•°æ®ç§»åŠ¨åˆ°ä»“åº“æŒ‡å‘çš„è·¯å¾„ã€‚å¦‚æœåˆ›å»ºäº†å¤–éƒ¨è¡¨çš„ï¼Œå®ƒåªä¼šè®°å½•æ•°æ®æ‰€åœ¨çš„è·¯å¾„ï¼Œè€Œä¸æ›´æ”¹æ•°æ®çš„ä½ç½®ã€‚
  Create table wdnmd() row format delimited fields terminated by 'åˆ†éš”ç¬¦' lines terminated by '\n' stored as æ–‡ä»¶ç±»å‹ï¼ˆé»˜è®¤æ˜¯æ—¶TEXTFILEï¼‰
  #åˆ›å»ºåˆ†åŒºè¡¨
  create table if not exists part_table() partiotioned by(ss string) row format delimited fields terminated by ',' lines terminated by '\n';
  #åˆ›å»ºåˆ†æ¡¶è¡¨
  create table if not exists test_bucket(id int) partiotioned by(ss string) clustered by (id) into 3 buckets row format delimited fields terminated by ',' lines terminated by '\n';
  #å¤åˆ¶è¡¨ç»“æ„
  create table test_liek_table like test_bucket;
  ```

- ```sql
  è¡¨é‡å‘½åï¼šalter table table_name rename to new_name
  ä¿®æ”¹è¡¨çš„åˆ—ç±»å‹ï¼šalter table table_name  old_column_name new_column_name column_type;
  æ·»åŠ åˆ—ï¼šalter table table_nameadd columns (d int);
  æ›´æ”¹åˆ—åï¼š alter table table_name change column_name new_name string;
  åˆ é™¤åˆ—å¹¶åˆ›å»ºæ–°åˆ—åï¼šalter table table_name replace columns(id int,name string);
  ```

### 5.1æ‰˜ç®¡è¡¨å’Œå†…éƒ¨è¡¨

- å†…éƒ¨è¡¨çš„ç‰¹ç‚¹

  - å†…éƒ¨è¡¨ç”±hiveæ§åˆ¶
  - **è®¿é—®å†…éƒ¨è¡¨çš„æ•°æ®å”¯ä¸€çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨hive**ã€‚æ— è®ºæ•°æ®çš„ä½ç½®æ˜¯HDFSè¿˜æ˜¯hiveè‡ªå·±çš„ä»“åº“ç›®å½•ï¼Œ**HIveä¸å…è®¸å…¶ä»–çš„ä»»ä½•åº”ç”¨ç¨‹åºè®¿é—®è¯¥æ•°æ®**Â®Â®Â®Â®

  - å¦‚æœå¿…é¡»è®¿é—®å†…éƒ¨è¡¨çš„æ•°æ®ï¼Œåªèƒ½å¯¹è¯¥è¡¨ä½¿ç”¨HIveæŸ¥è¯¢

- å¤–éƒ¨è¡¨çš„ç‰¹ç‚¹ï¼š
  - åªæœ‰å­˜å‚¨åœ¨metastoreçš„å…ƒæ•°æ®ç”±hiveæ§åˆ¶

### 5.2 å°†æ•°æ®åŠ è½½åˆ°Hive

- åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼ŒLOCALå…³é”®è¯æŒ‡å®šæ–‡ä»¶åœ¨ä¸»æœºä¸­çš„ä½ç½®ã€‚ **å¦‚æœæœªæŒ‡å®šLOCALå…³é”®å­—ï¼Œå°†ä»inpathä¹‹åæŒ‡å®šçš„URIæˆ–fs.default.name Hiveå±æ€§ä¸­çš„å€¼åŠ è½½æ–‡ä»¶ï¼Œè€ŒOverriteå†³å®šæ˜¯è¿½åŠ è¿˜æ˜¯æ›¿æ¢ç°æœ‰æ•°æ®**
- æœ¬åœ°ï¼š`load data local inpath '/////' into table table_name`
- HDFS:`load data inpath '/user/.../... into table table_name'`

### ğŸ¥ğŸ¥Hiveåˆ†åŒºğŸ¥ğŸ¥

- åˆ†åŒºçš„é‡è¦æ€§
  - åˆ†åŒºæ˜¯ä¸€ç§æ ¹æ®ç‰¹å®šåˆ—çš„å€¼å°†è¡¨åˆ’åˆ†ä¸ºç›¸å…³éƒ¨åˆ†çš„æ–¹æ³•â²å…ˆæä¸€ä¸‹HIveåœ¨æŸ¥è¯¢ä¸­çš„ä½œç”¨ï¼šhiveå°†SQLæŸ¥è¯¢è½¬æ¢ä¸ºMapreduceä½œä¸šï¼Œç„¶åå°†å…¶æäº¤åˆ°Hadoopé›†ç¾¤ã€‚æäº¤SQLæŸ¥è¯¢æ—¶ï¼ŒHIveè¯»å–æ•´ä¸ªæ•°æ®é›†ã€‚
